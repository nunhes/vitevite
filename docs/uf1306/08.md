---
title: Validaci√≥n no lado do servidor (Back-End)
description: A validaci√≥n no lado do servidor √© unha parte cr√≠tica no desenvolvemento web.
lastUpdated: true
---

# {{ $frontmatter.title }}

A validaci√≥n no lado do servidor √© unha parte **cr√≠tica** no desenvolvemento web, xa que act√∫a como a **√∫ltima li√±a de defensa** contra datos incorrectos, maliciosos ou non desexados. A√≠nda que a validaci√≥n no cliente (front-end) mellora a experiencia do usuario, **nunca debe confiarse s√≥ nela**, xa que pode ser evitada ou manipulada.  

---

## **üîí Por que √© importante a validaci√≥n no servidor?**  
1. **Seguridade**:  
   - Evita inxecci√≥ns SQL, XSS (Cross-Site Scripting) e outros ataques.  
   - Os usuarios malintencionados poden enviar datos directamente ao servidor (ex: con ferramentas como Postman ou curl).  

2. **Consistencia dos datos**:  
   - Garante que os datos cumpran as regras de negocio antes de almacenalos nunha BD.  

3. **Independencia do cliente**:  
   - Funciona igual independentemente de que o front-end sexa un navegador, unha app m√≥bil ou unha API.  

4. **Prevenci√≥n de erros**:  
   - Evita que datos incorrectos rompan a l√≥xica da aplicaci√≥n.  

---

## **üìå T√©cnicas com√∫ns de validaci√≥n no servidor**  

### **1Ô∏è‚É£ Comprobaci√≥n de campos obrigatorios**  
Aseg√∫rase de que os campos esenciais non estean baleiros.  

**Exemplo en PHP:**  
```php
if (empty($_POST['nome'])) {
    $erros['nome'] = "O nome √© obrigatorio";
}
```

### **2Ô∏è‚É£ Validaci√≥n de formatos**  
Verifica que os datos cumpran un patr√≥n espec√≠fico.  

**üìß Validaci√≥n de email:**  
```php
if (!filter_var($_POST['email'], FILTER_VALIDATE_EMAIL)) {
    $erros['email'] = "O email non √© v√°lido";
}
```

**üìû Validaci√≥n de tel√©fono (con expresi√≥n regular):**  
```php
if (!preg_match('/^[0-9]{9}$/', $_POST['telefono'])) {
    $erros['telefono'] = "O tel√©fono debe ter 9 d√≠xitos";
}
```

### **3Ô∏è‚É£ Rango e lonxitude de datos**  
Comproba que os valores estean dentro de l√≠mites aceptables.  

**Exemplo (contrase√±a entre 6 e 20 caracteres):**  
```php
$contrasinal = $_POST['contrasinal'];
if (strlen($contrasinal) < 6 || strlen($contrasinal) > 20) {
    $erros['contrasinal'] = "A contrasinal debe ter entre 6 e 20 caracteres";
}
```

**Exemplo (idade entre 18 e 99 anos):**  
```php
$idade = $_POST['idade'];
if ($idade < 18 || $idade > 99) {
    $erros['idade'] = "A idade debe estar entre 18 e 99 anos";
}
```

### **4Ô∏è‚É£ Expresi√≥ns regulares (regex) para padr√≥ns complexos**  
√ösanse para validar estruturas m√°is complexas, como:  
- **NIF/NIE** (formato espa√±ol)  
- **Tarxetas de cr√©dito**  
- **C√≥digos postais**  

**Exemplo (validar un c√≥digo postal espa√±ol - 5 d√≠xitos):**  
```php
if (!preg_match('/^[0-9]{5}$/', $_POST['codigo_postal'])) {
    $erros['codigo_postal'] = "O c√≥digo postal debe ter 5 d√≠xitos";
}
```

**Exemplo (validar unha contrasinal con letras, n√∫meros e s√≠mbolos):**  
```php
if (!preg_match('/^(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*]).{8,}$/', $_POST['contrasinal'])) {
    $erros['contrasinal'] = "A contrasinal debe ter polo menos 8 caracteres, unha mai√∫scula, un n√∫mero e un s√≠mbolo";
}
```

---

## **üõ°Ô∏è Boas pr√°cticas en validaci√≥n de servidor**  
‚úÖ **Sanitizaci√≥n de datos**:  
   - Eliminar espazos en branco (`trim()`).  
   - Escapar caracteres perigosos (`htmlspecialchars()`, `mysqli_real_escape_string()`).  

‚úÖ **Validaci√≥n antes de procesar**:  
   - Non confiar en datos sen validar.  

‚úÖ **Mensaxes de erro claras**:  
   - Informar ao usuario do erro sen revelar detalles t√©cnicos.  

‚úÖ **Reutilizaci√≥n de validaci√≥ns**:  
   - Usar funci√≥ns ou clases para non repetir c√≥digo.  

---

## **üìå Resumo final**  
| **Aspecto**           | **Validaci√≥n Cliente (Front-End)** | **Validaci√≥n Servidor (Back-End)** |
| --------------------- | ---------------------------------- | ---------------------------------- |
| **Obxectivo**         | Mellorar UX (r√°pido)               | Seguridade e integridade dos datos |
| **Pode ser evitada?** | **SI** (desactivando JS)           | **NON** (√∫ltima li√±a de defensa)   |
| **T√©cnicas**          | HTML5, JavaScript                  | PHP, Python, Node.js, Regex, BD    |

### **üîπ Conclusi√≥n**  
A validaci√≥n no servidor √© **obrigatoria** en calquera aplicaci√≥n web. Non s√≥ protexe contra erros, sen√≥n tam√©n contra ataques maliciosos. **Nunca conf√≠es s√≥ na validaci√≥n do cliente!**  

----

## üöÄ **Exemplo Pr√°ctico: Validaci√≥n en Front-End e Back-End**

**Formulario de rexistro con validaci√≥n en JavaScript (UX) e PHP (seguridade)**  

Neste exemplo, construiremos un **formulario de rexistro** con:  
‚úÖ **Validaci√≥n en JavaScript** (para unha boa experiencia de usuario ‚Üí UX)  
‚úÖ **Validaci√≥n en PHP** (para seguridade e integridade dos datos)  

---

## **üìù Estrutura do Proxecto**

```
üìÇ formulario-rexistro/  
‚îú‚îÄ‚îÄ üìÑ index.html       (Front-End: HTML + CSS + JS)  
‚îú‚îÄ‚îÄ üìÑ validacion.js    (Validaci√≥n en JavaScript)  
‚îî‚îÄ‚îÄ üìÑ procesar.php     (Validaci√≥n en PHP e resposta)  
```

---

## **1Ô∏è‚É£ Front-End (HTML + JavaScript)**

### **üìÑ index.html**  
```html
<!DOCTYPE html>
<html lang="gl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rexistro de Usuario</title>
    <style>
        .error { color: red; font-size: 0.9em; }
        .exito { color: green; }
        .oculto { display: none; }
        input.invalido { border: 1px solid red; }
    </style>
</head>
<body>
    <h1>Rexistro</h1>
    <form id="formularioRexistro" method="POST" action="procesar.php">
        <div>
            <label for="nome">Nome:</label>
            <input type="text" id="nome" name="nome" required>
            <span id="errorNome" class="error oculto"></span>
        </div>

        <div>
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
            <span id="errorEmail" class="error oculto"></span>
        </div>

        <div>
            <label for="contrasinal">Contrasinal (m√≠n. 6 caracteres):</label>
            <input type="password" id="contrasinal" name="contrasinal" required>
            <span id="errorContrasinal" class="error oculto"></span>
        </div>

        <div>
            <label for="confirmarContrasinal">Confirmar Contrasinal:</label>
            <input type="password" id="confirmarContrasinal" name="confirmarContrasinal" required>
            <span id="errorConfirmarContrasinal" class="error oculto"></span>
        </div>

        <button type="submit">Rexistrarse</button>
    </form>

    <div id="mensaxeExito" class="exito oculto"></div>

    <script src="validacion.js"></script>
</body>
</html>
```

---

### **üìÑ validacion.js** (Validaci√≥n en JavaScript)  
```javascript
document.addEventListener('DOMContentLoaded', () => {
    const formulario = document.getElementById('formularioRexistro');

    formulario.addEventListener('submit', (e) => {
        e.preventDefault(); // Evita o env√≠o directo (validamos primeiro)
        
        limparErros();
        
        if (validarFormulario()) {
            // Se a validaci√≥n √© correcta, enviamos os datos ao servidor
            enviarDatos();
        }
    });

    function validarFormulario() {
        let valido = true;
        const nome = document.getElementById('nome').value.trim();
        const email = document.getElementById('email').value.trim();
        const contrasinal = document.getElementById('contrasinal').value;
        const confirmarContrasinal = document.getElementById('confirmarContrasinal').value;

        // Validaci√≥n do nome (m√≠nimo 3 caracteres)
        if (nome.length < 3) {
            mostrarError('errorNome', 'O nome debe ter polo menos 3 caracteres');
            valido = false;
        }

        // Validaci√≥n do email (formato correcto)
        const regexEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!regexEmail.test(email)) {
            mostrarError('errorEmail', 'O email non √© v√°lido');
            valido = false;
        }

        // Validaci√≥n da contrasinal (m√≠nimo 6 caracteres)
        if (contrasinal.length < 6) {
            mostrarError('errorContrasinal', 'A contrasinal debe ter polo menos 6 caracteres');
            valido = false;
        }

        // Confirmaci√≥n da contrasinal
        if (contrasinal !== confirmarContrasinal) {
            mostrarError('errorConfirmarContrasinal', 'As contrasinais non coinciden');
            valido = false;
        }

        return valido;
    }

    function mostrarError(idElemento, mensaxe) {
        const elemento = document.getElementById(idElemento);
        elemento.textContent = mensaxe;
        elemento.classList.remove('oculto');
        document.getElementById(idElemento.replace('error', '')).classList.add('invalido');
    }

    function limparErros() {
        document.querySelectorAll('.error').forEach((error) => {
            error.textContent = '';
            error.classList.add('oculto');
        });
        document.querySelectorAll('input').forEach((input) => {
            input.classList.remove('invalido');
        });
    }

    function enviarDatos() {
        const formulario = document.getElementById('formularioRexistro');
        const datos = new FormData(formulario);

        fetch('procesar.php', {
            method: 'POST',
            body: datos
        })
        .then(response => response.json())
        .then(data => {
            if (data.exito) {
                // √âxito: Mostrar mensaxe e limpar formulario
                document.getElementById('mensaxeExito').textContent = data.mensaxe;
                document.getElementById('mensaxeExito').classList.remove('oculto');
                formulario.reset();
            } else {
                // Erros do servidor (ex: email xa rexistrado)
                if (data.erros) {
                    for (const campo in data.erros) {
                        mostrarError(`error${campo.charAt(0).toUpperCase() + campo.slice(1)}`, data.erros[campo]);
                    }
                }
            }
        })
        .catch(error => {
            console.error('Error:', error);
            mostrarError('errorNome', 'Houbo un erro ao conectar co servidor');
        });
    }
});
```

---

## **2Ô∏è‚É£ Back-End (PHP - Validaci√≥n e Seguridade)**  
### **üìÑ procesar.php**  
```php
<?php
header('Content-Type: application/json');

$erros = [];
$exito = false;

// Recoller e sanitizar datos
$nome = isset($_POST['nome']) ? trim($_POST['nome']) : '';
$email = isset($_POST['email']) ? trim($_POST['email']) : '';
$contrasinal = isset($_POST['contrasinal']) ? $_POST['contrasinal'] : '';
$confirmarContrasinal = isset($_POST['confirmarContrasinal']) ? $_POST['confirmarContrasinal'] : '';

// Validaci√≥ns no servidor
if (empty($nome)) {
    $erros['nome'] = 'O nome √© obrigatorio';
} elseif (strlen($nome) < 3) {
    $erros['nome'] = 'O nome debe ter polo menos 3 caracteres';
}

if (empty($email)) {
    $erros['email'] = 'O email √© obrigatorio';
} elseif (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
    $erros['email'] = 'O email non √© v√°lido';
}

if (empty($contrasinal)) {
    $erros['contrasinal'] = 'A contrasinal √© obrigatoria';
} elseif (strlen($contrasinal) < 6) {
    $erros['contrasinal'] = 'A contrasinal debe ter polo menos 6 caracteres';
}

if ($contrasinal !== $confirmarContrasinal) {
    $erros['confirmarContrasinal'] = 'As contrasinais non coinciden';
}

// Se non hai erros, procesar datos (ex: gardar en BD)
if (empty($erros)) {
    // Nunca almacenar contrasinais en texto plano! Usar password_hash()
    $contrasinalHash = password_hash($contrasinal, PASSWORD_DEFAULT);

    // Aqu√≠ ir√≠a a conexi√≥n √° BD e inserci√≥n do usuario
    // $pdo = new PDO(...);
    // $stmt = $pdo->prepare("INSERT INTO usuarios (nome, email, contrasinal) VALUES (?, ?, ?)");
    // $stmt->execute([$nome, $email, $contrasinalHash]);

    $exito = true;
    $resposta = [
        'exito' => true,
        'mensaxe' => '‚úÖ Rexistro completado con √©xito!'
    ];
} else {
    $resposta = [
        'exito' => false,
        'erros' => $erros
    ];
}

echo json_encode($resposta);
?>
```

---

## **üìå Resumo do fluxo**

1. **O usuario enche o formulario** ‚Üí JavaScript valida en tempo real.  
2. **Se a validaci√≥n √© correcta**, env√≠ase ao servidor con `fetch()`.  
3. **O PHP valida de novo** (seguridade) e responde con JSON.  
4. **Se hai erros**, m√≥stranselle ao usuario.  
5. **Se todo √© correcto**, m√≥strase unha mensaxe de √©xito.  

---

## **üîπ Conclusi√≥n**  
‚úÖ **Validaci√≥n en Front-End (JS)**:  
   - Mellora a experiencia do usuario (erros instant√°neos).  
   - Evita enviar datos incorrectos ao servidor.  

‚úÖ **Validaci√≥n en Back-End (PHP)**:  
   - √öltima li√±a de defensa contra datos maliciosos.  
   - Garante a integridade dos datos antes de gardalos.  

üöÄ **Pr√°ctica recomendada**: **Usar sempre ambas validaci√≥ns** para unha aplicaci√≥n segura e usable.  

üì¢ **Nota**: Nunha aplicaci√≥n real, tam√©n deber√≠as:  
- Usar **prepared statements** para evitar inxecci√≥n SQL.  
- Almacenar contrasinais con **`password_hash()`**.  
- Implementar **CSRF tokens** para evitar ataques.  



---

DAWüßä2025