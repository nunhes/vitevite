---
title: Caracter√≠sticas de seguridade na publicaci√≥n de p√°xinas web i
description: A seguridade web √© fundamental para protexer tanto os datos dos usuarios como a infraestrutura do servidor. 
lastUpdated: true
---

# {{ $frontmatter.title }}

## **1. Introduci√≥n**  
> A seguridade web √© fundamental para protexer tanto os datos dos usuarios como a infraestrutura do servidor. Cando se publica unha p√°xina web, √© necesario implementar medidas que prev√±an ataques como inxecci√≥ns SQL, XSS, roubo de datos ou denegaci√≥n de servizo (DDoS). 

### **Protecci√≥n integral para aplicaci√≥ns e infraestruturas**

A seguridade web constit√∫e un pilar fundamental no desenvolvemento de aplicaci√≥ns e sitios web, xa que garante a protecci√≥n tanto da informaci√≥n dos usuarios como dos sistemas que a aloxan. Nun contexto digital cada vez m√°is complexo e ameazado por ciberriscos, a implementaci√≥n de estratexias de seguridade robustas conv√©rtese en obrigatoria para calquera proxecto en li√±a.

**Principais ameazas e contramedidas:**

1. **Inxecci√≥n SQL**: 
   - *Risco*: Permite a execuci√≥n de c√≥digo malicioso en bases de datos mediante consultas non validadas.
   - *Soluci√≥n*: Uso de consultas parametrizadas, ORMs e ferramentas como *[prepared statements](https://www.ionos.es/digitalguide/paginas-web/desarrollo-web/prepared-statements/)*. Validaci√≥n estrita de inputs.

2. **Cross-Site Scripting (XSS)**:
   - *Risco*: Inxecci√≥n de scripts maliciosos que se executan no navegador do usuario.
   - *Soluci√≥n*: Sanitizaci√≥n de datos, implementaci√≥n de Content Security Policy (CSP) e uso de librar√≠as seguras como DOMPurify.

3. **Ataques DDoS**:
   - *Risco*: Sobrecarga dos servidores mediante tr√°fico malicioso.
   - *Soluci√≥n*: Configuraci√≥n de firewalls, uso de CDNs e servizos especializados como Cloudflare.

4. **Roubo de Datos**:
   - *Risco*: Compromiso de informaci√≥n sensible como credenciais ou datos persoais.
   - *Soluci√≥n*: Encriptaci√≥n forte (TLS 1.3), hash con sal para contrasinais e autenticaci√≥n multifactor.

**Boas Pr√°cticas Adicionais:**
- Actualizaci√≥ns peri√≥dicas de sistemas e dependencias
- Auditor√≠as de seguridade e pentesting regular
- Configuraci√≥n adecuada de cabeceiras HTTP de seguridade
- Principio de m√≠nimo privilexio en permisos
- Backups cifrados e plan de recuperaci√≥n ante desastres

A seguridade web non √© un produto sen√≥n un proceso continuo que require manterse actualizado ante as novas vulnerabilidades e t√©cnicas de ataque. Invertir nunha arquitectura segura dende o dese√±o ([Security by Design](https://aodatacloud.es/blog/security-by-design-principios-ventajas-y-mejores-practicas/)) aforrar√° custos e danos reputacionais a medio-longo prazo.

![Os 7 principios de Security by Design](./assets/Los-7-principios-de-Security-by-Design-1024x409.png)

<center><small>*Os 7 principios de Security by Design*</small></center>

*Nota*: Recom√©ndase seguir os est√°ndares [OWASP](https://owasp.org/www-project-top-ten/) e contar con especialistas en ciberseguridade para proxectos cr√≠ticos.

---

## **2. Principais caracter√≠sticas de seguridade**  
A seguridade web √© crucial para protexer tanto os teus datos como os dos teus usuarios. 

### **üîí 2.1. Uso de HTTPS (SSL/TLS)**

- **Obxectivo**: Cifrar a comunicaci√≥n entre o cliente e o servidor.  

#### **Protecci√≥n de datos en tr√°nsito: Implementaci√≥n de HTTPS con SSL/TLS**

##### **Obxectivo**

Garantir a **confidencialidade e integridade** dos datos transmitidos entre o cliente e o servidor mediante cifrado forte, evitando ataques como *Man-in-the-Middle (MITM)*, espionaxe ou manipulaci√≥n de informaci√≥n sensible (credenciais, datos persoais, pagos, etc.).

---

##### **Como implementalo correctamente**

1. **Obtenci√≥n dun certificado SSL/TLS**  
   - **Opci√≥ns gratu√≠tas**:  
     - **Let‚Äôs Encrypt** (automatizado con Certbot, renovaci√≥n autom√°tica).  
     - **Cloudflare** (SSL flexible/full/strict en combinaci√≥n co seu CDN).  
   - **Opci√≥ns comerciais** (recomendable para eCommerce, banca, etc.):  
     - **DigiCert**, **Sectigo**, **GlobalSign** (certificados EV con validaci√≥n estendida).  
   - **Certificados wildcard** (*.dominio.com) para subdominios.  

2. **Configuraci√≥n do Servidor Web**  
   - **Apache**:  
     ```apache
     <VirtualHost *:80>
         ServerName teudominio.com
         Redirect permanent / https://teudominio.com/
     </VirtualHost>
     <VirtualHost *:443>
         SSLEngine on
         SSLCertificateFile /ruta/certificado.crt
         SSLCertificateKeyFile /ruta/chave-privada.key
         SSLCertificateChainFile /ruta/cadea.crt
     </VirtualHost>
     ```
   - **Nginx**:  
     ```nginx
     server {
         listen 80;
         server_name teudominio.com;
         return 301 https://$server_name$request_uri;
     }
     server {
         listen 443 ssl;
         ssl_certificate /ruta/certificado.pem;
         ssl_certificate_key /ruta/chave-privada.key;
         ssl_protocols TLSv1.2 TLSv1.3;
         ssl_prefer_server_ciphers on;
     }
     ```

3. **Forzar redirecci√≥n HTTP ‚Üí HTTPS**  
   - Configurar **HSTS (HTTP Strict Transport Security)** para evitar downgrade attacks:  
     ```http
     Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
     ```
   - Eliminar contido mixto (*mixed content*) con ferramentas como **Why No Padlock?**.

4. **Validaci√≥n e optimizaci√≥n**  
   - **SSL Labs** (https://www.ssllabs.com/ssltest/): Verificar cualificaci√≥n *A+*, soporte para TLS 1.3 e cifrados seguros (AES-GCM, ChaCha20).  
   - **Security Headers** (https://securityheaders.com/): Asegurar cabeceiras como `Content-Security-Policy`.  
   - **Renovaci√≥n autom√°tica** (cron jobs para Let‚Äôs Encrypt).  

5. **Boas pr√°cticas adicionais**  
   - **OCSP Stapling**: Reduci√≥n da latencia na validaci√≥n de certificados.  
   - **Cifrado moderno**: Deshabilitar SSLv3, TLS 1.0/1.1 e cifrados obsoletos (RC4, DES).  
   - **HPKP (deprecado) ‚Üí Usar Certificate Transparency** (CT logs).  

##### **Impacto**

- ‚úÖ **SEO**: Google prioriza sitios HTTPS no ranking.  
- ‚úÖ **UX**: Indicador de cadeado verde no navegador (confianza do usuario).  
- ‚úÖ **Legal**: Cumpre regulaci√≥ns como **GDPR**.  

*Nota*: A seguridade non √© est√°tica. Revisar anualmente a configuraci√≥n e estar atento a vulnerabilidades como **Heartbleed** ou **POODLE*.

#### **Como implementalo**:  

- Obter un certificado SSL/TLS (gratu√≠to con Let‚Äôs Encrypt ou de pago con Comodo, Symantec, etc.).  
- Configurar o servidor (Apache, Nginx) para redirixir HTTP ‚Üí HTTPS.  
- Validar a correcta instalaci√≥n con ferramentas como [SSL Labs](https://www.ssllabs.com/ssltest/).  

### **üõ°Ô∏è 2.2. Validaci√≥n de datos (Input Sanitization)**

- **Obxectivo**: Evitar ataques como **SQL Injection** ou **XSS**.  

#### **Validaci√≥n e sanitizaci√≥n de datos: Protecci√≥n contra inxecci√≥ns e ataques maliciosos**

##### **Obxectivo**

Garantir que **todos os datos** proporcionados polos usuarios (formularios, URLs, API requests, etc.) sexan **validados, filtrados e sanitizados** antes do seu procesamento, prevenindo vulnerabilidades cr√≠ticas como:  
- **SQL Injection** (execuci√≥n de c√≥digo malicioso en bases de datos).  
- **Cross-Site Scripting (XSS)** (inxecci√≥n de scripts no navegador das v√≠timas).  
- **Command Injection** (execuci√≥n arbitraria de comandos no servidor).  

---

#### **Estratexias de implementaci√≥n**

##### **1. Validaci√≥n de entradas (Input Validation)**

- **Definir regras estritas** por tipo de dato:  
  - **Textos**: Lonxitude m√°xima/m√≠nima, caracteres permitidos (ex.: `^[a-zA-Z0-9_-]+$`).  
  - **N√∫meros**: Rangos v√°lidos (ex.: `0-100` para porcentaxes).  
  - **Emails**: Usar funci√≥ns nativas (`filter_var($email, FILTER_VALIDATE_EMAIL)` en PHP) ou regex est√°ndar.  
  - **URLs**: Validar estrutura e protocolos permitidos (`http://`, `https://`).  

- **Ferramentas**:  
  - **Librar√≠as**: `Validator.js` (JavaScript), `class-validator` (TypeScript), `OWASP ESAPI`.  
  - **Frameworks**: Validadores integrados en Laravel, Django, Spring Boot.  

##### **2. Sanitizaci√≥n de datos (Input Sanitization)**

- **Eliminar/escapar caracteres perigosos**:  
  - **Bases de datos**: Usar **consultas parametrizadas** (prepared statements):  
    ```php
    // PHP con PDO (evita SQL Injection)
    $stmt = $pdo->prepare("SELECT * FROM usuarios WHERE email = :email");
    $stmt->execute(['email' => $email]);
    ```
  - **HTML/JavaScript**: Sanitizar con `DOMPurify` (XSS prevention):  
    ```javascript
    import DOMPurify from 'dompurify';
    const cleanHTML = DOMPurify.sanitize(userInput);
    ```
  - **Sistemas de templates**: Auto-escaping en Twig (Symfony), Jinja2 (Python), ou React (`dangerouslySetInnerHTML` s√≥ en casos excepcionais).  

##### **3. Boas pr√°cticas avanzadas**

- **Principio do m√≠nimo privilexio**:  
  - As consultas √° BD deben executarse con usuarios con permisos restritivos (nunca como `root`).  
- **Capa de validaci√≥n en frontend e backend**:  
  - **Non confiar s√≥ no JavaScript** (pode ser deshabilitado). Validar sempre no servidor.  
- **Logging e monitorizaci√≥n**:  
  - Rexistrar intentos de inxecci√≥n (ferramentas como **OWASP ModSecurity**).  
- **Actualizaci√≥ns**:  
  - Mant√©n as librar√≠as de sanitizaci√≥n ([`DOMPurify`](https://github.com/cure53/DOMPurify) (+[1](https://www.incibe.es/incibe-cert/alerta-temprana/vulnerabilidades/cve-2024-45801)), [`html-escaper`](https://github.com/WebReflection/html-escaper)) actualizadas.  

---

#### **Exemplos pr√°cticos por linguaxe**

##### **PHP**

```php
// Validaci√≥n + Sanitizaci√≥n
$email = filter_var($_POST['email'], FILTER_VALIDATE_EMAIL);
$username = htmlspecialchars($_POST['username'], ENT_QUOTES, 'UTF-8');
```

##### **Python (Django)**

```python
from django.core.validators import validate_email
from django.utils.html import escape

email = validate_email(request.POST['email'])  # Lanza excepci√≥n si non √© v√°lido
safe_text = escape(request.POST['comentario'])
```

##### **JavaScript (Node.js)**

```javascript
const validator = require('validator');
const cleanInput = validator.escape(maliciousInput);
```

---

#### **Ferramentas recomendadas**

- **OWASP Cheat Sheets**: Gu√≠as de validaci√≥n/sanitizaci√≥n por tecnolox√≠a.  
- **SonarQube**: An√°lise est√°tico de c√≥digo para detectar vulnerabilidades.  
- **Burp Suite**: Testeo manual de inputs en aplicaci√≥ns web.  

> üîê **Lembra**: A validaci√≥n e sanitizaci√≥n son **esenciais** tanto en aplicaci√≥ns novas como en proxectos herdados. Incl√∫e estas pr√°cticas no teu **SDLC** (Ciclo de Vida de Desenvolvemento de Software) dende o dese√±o inicial.

#### **Boas pr√°cticas**:

- - Usar consultas parametrizadas (prepared statements) en bases de datos.  
  - Filtrado de entradas con librar√≠as como `OWASP ESAPI` ou `DOMPurify` (para JavaScript).  
  - Validar datos con regex ou funci√≥ns espec√≠ficas (ex.: [`filter_var()`](https://www.w3schools.com/php/func_filter_var.asp) en PHP).  

### **üîê 2.3. Xesti√≥n segura de contrasinais**

#### **Xesti√≥n segura de contrasinais: mellores pr√°cticas e estratexias avanzadas**

##### **üîê Obxectivo**

Protexer as credenciais dos usuarios mediante t√©cnicas de **almacenamento seguro**, **autenticaci√≥n robusta** e **protecci√≥n contra ataques**, garantindo a privacidade e integridade dos datos.  

---

#### **üìå Recomendaci√≥ns clave**

##### **1. Almacenamento seguro de contrasinais**

‚úÖ **Usar algoritmos de hash modernos e lentos**:  
   - **Bcrypt** (recomendado para a maior√≠a dos casos, xa que incl√∫e *salt* autom√°tico e √© resistente a GPU/ASIC).  
   - **Argon2** (ga√±ador do *Password Hashing Competition*, ideal para sistemas que requiren m√°xima seguridade).  
   - **PBKDF2** (√∫til en sistemas legados, pero menos eficiente que Bcrypt/Argon2).  

üö´ **Evitar m√©todos inseguros**:  
   - **MD5, SHA-1, SHA-256** (son r√°pidos e vulnerables a ataques de forza bruta).  
   - **Encriptaci√≥n sim√©trica** (AES, DES) ‚Üí Os contrasinais deben **hashearse**, non cifrarse.  

üìå **Exemplo de implementaci√≥n (Node.js con bcrypt)**:  
```javascript
const bcrypt = require('bcrypt');  
const saltRounds = 12; // Coste computacional (recomendado >= 10)  

const hashPassword = async (password) => {  
  return await bcrypt.hash(password, saltRounds);  
};  

const checkPassword = async (password, hash) => {  
  return await bcrypt.compare(password, hash);  
};  
```

---

##### **2. Autenticaci√≥n en dous factores (2FA)**

‚úÖ **M√©todos recomendados**:  
   - **Aplicaci√≥ns de autenticaci√≥n** (Google Authenticator, Authy, Microsoft Authenticator).  
   - **Chaves f√≠sicas U2F** (YubiKey, Titan Security Key).  
   - **SMS ou correo electr√≥nico** (menos seguro, pero mellor que nada).  

üìå **Exemplo con Node.js e Speakeasy (TOTP)**:  
```javascript
const speakeasy = require('speakeasy');  

// Xerar secreto 2FA  
const secret = speakeasy.generateSecret({ length: 20 });  

// Verificar c√≥digo  
const verified = speakeasy.totp.verify({  
  secret: secret.base32,  
  encoding: 'base32',  
  token: userProvidedToken  
});  
```

---

##### **3. Protecci√≥n contra ataques de forza bruta**

‚úÖ **Estratexias de mitigaci√≥n**:  
   - **L√≠mite de intentos** (bloquear tras 3-5 intentos fallidos).  
   - **Retardos exponenciais** (ex.: 1s, 2s, 4s, 8s‚Ä¶).  
   - **CAPTCHA** (reCAPTCHA v3 para evitar bots).  
   - **Listas negras de IPs** (usando fail2ban ou Cloudflare WAF).  

üìå **Exemplo en PHP con bloqueo temporal**:  
```php
session_start();  
if ($_SESSION['login_attempts'] >= 5) {  
  die("Demasiados intentos. Espera 10 minutos.");  
}  

if (!password_verify($input_password, $stored_hash)) {  
  $_SESSION['login_attempts']++;  
  sleep($_SESSION['login_attempts']); // Retardo exponencial  
}  
```

---

##### **üîß Boas pr√°cticas adicionais**

- **Requisitos de complexidade**:  
  - M√≠nimo **12 caracteres** (letras, n√∫meros, s√≠mbolos).  
  - Evitar contrasinais com√∫ns (`123456`, `password`).  
- **Renovaci√≥n peri√≥dica** (cada 3-6 meses en sistemas cr√≠ticos).  
- **Notificaci√≥ns de acceso sospeitoso** (email/alerta por novo dispositivo).  

---

##### **üìä Comparativa de algoritmos de ``hash``**

| Algoritmo  | Resistencia a GPU/ASIC | Salt autom√°tico | Velocidade  |
| ---------- | ---------------------- | --------------- | ----------- |
| **Bcrypt** | ‚úÖ Alta                 | ‚úÖ Si            | ‚è≥ Lento     |
| **Argon2** | ‚úÖ Moi Alta             | ‚úÖ Si            | ‚è≥ Moi Lento |
| **PBKDF2** | ‚ùå Moderada             | ‚ùå Non           | üèéÔ∏è R√°pido    |

---

##### **üöÄ Conclusi√≥n**

Unha **xesti√≥n segura de contrasinais** require:  
1. **Hash robusto** (Bcrypt/Argon2).  
2. **2FA** para autenticaci√≥n adicional.  
3. **Protecci√≥n contra forza bruta**.  
4. **Monitorizaci√≥n continua** para detectar intentos de compromiso.  

üîó **Recursos recomendados**:  
- [OWASP Password Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html)  
- [Have I Been Pwned?](https://haveibeenpwned.com/) (para verificar contrasinais comprometidos).  

Implementar estas medidas reducir√° drasticamente o risco de **fuga de credenciais** e **ataques a contas de usuario**.

- **Recomendaci√≥ns**:  
  - Almacenar contrasinais con **hash seguro** (bcrypt, Argon2).  
  - Implementar autenticaci√≥n en dous factores (2FA).  
  - Limitar intentos de inicio de sesi√≥n para evitar **forza bruta**.  

### **üö´ 2.4. Protecci√≥n contra CSRF (Cross-Site Request Forgery). Estratexias Avanzadas**

#### **üîê Obxectivo**

Prevenir que un atacante engane a usuarios autenticados para realizar acci√≥ns non desexadas nunha aplicaci√≥n web, garantindo que todas as petici√≥ns leg√≠timas prove√±an do sitio web orixinal.

---

#### **üìå Soluci√≥ns efectivas**

##### **1. Tokens CSRF (Synchronizer Token Pattern)**

‚úÖ **Como funciona**:
   - O servidor xera un token √∫nico e aleatorio para cada sesi√≥n de usuario.
   - O token incl√∫ese en formularios ou petici√≥ns AJAX como campo oculto.
   - O servidor valida o token en cada petici√≥n POST/PUT/DELETE.

‚úÖ **Implementaci√≥n**:
   - **En formularios**:
     ```html
     <form action="/transferencia" method="POST">
       <input type="hidden" name="_csrf" value="token-xerado-polo-servidor">
       <!-- Outros campos -->
     </form>
     ```
   - **En APIs REST** (cabeceira HTTP):
     ```http
     X-CSRF-Token: token-xerado-polo-servidor
     ```

   - **Exemplo en Express.js**:
     ```javascript
     const csrf = require('csurf');
     app.use(csrf({ cookie: true }));
     ```

##### **2. Configuraci√≥n segura de *cookies***

‚úÖ **Cabeceira `SameSite`**:
   - `SameSite=Strict`: A cookie s√≥ se env√≠a en solicitudes do mesmo sitio (m√°is seguro).
   - `SameSite=Lax` (recomendado): Permite algunhas solicitudes cruzadas (ex.: navegaci√≥n b√°sica).
   - `SameSite=None`: S√≥ se usa con `Secure` (HTTPS obrigatorio).

   - **Exemplo de configuraci√≥n**:
     ```http
     Set-Cookie: sessionId=123; SameSite=Lax; Secure; HttpOnly
     ```

##### **3. Dobre env√≠o de cookies (Double Submit Cookie)**

‚úÖ **Alternativa sen almacenamento no servidor**:
   - O servidor env√≠a un token como cookie e espera o mesmo valor nun campo de formulario.
   - √ötil para arquitecturas sen estado (stateless).

---

#### **üîß Boas pr√°cticas adicionais**

##### **4. Validaci√≥n de orixe (Origin/Referer Headers)**

   - Rexeitar petici√≥ns con cabeceiras `Origin` ou `Referer` sospeitosas:
     ```javascript
     app.use((req, res, next) => {
       const origin = req.get('Origin');
       if (!allowedOrigins.includes(origin)) {
         return res.status(403).send('Prohibido');
       }
       next();
     });
     ```

##### **5. Limitaci√≥n temporal de *tokens***

   - Invalidar tokens CSRF despois dun tempo ou despois do primeiro uso (para operaci√≥ns cr√≠ticas).

##### **6. CAPTCHA para acci√≥ns cr√≠ticas**

   - Engadir CAPTCHA en operaci√≥ns sensibles (transferencias, cambios de contrasinal).

---

#### **üìä Comparativa de m√©todos CSRF**

| M√©todo               | Vantaxes                  | Desvantaxes                            |
| -------------------- | ------------------------- | -------------------------------------- |
| **Tokens CSRF**      | Alta seguridade           | Require almacenamento no servidor      |
| **SameSite Cookies** | Sinxelo de implementar    | Compatibilidade con navegadores vellos |
| **Double Submit**    | Ideal para APIs stateless | Menos seguro que tokens tradicionais   |

---

#### **üöÄ Conclusi√≥n**

Unha defensa completa contra CSRF require:
1. **Tokens CSRF** para formularios e APIs.
2. **Cookies con `SameSite=Lax`** como capa adicional.
3. **Validaci√≥n de cabeceiras** `Origin/Referer`.
4. **CAPTCHA** para operaci√≥ns de alto risco.

üîó **Recursos recomendados**:
- [OWASP CSRF Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html)
- [Gu√≠a de SameSite Cookies de Google](https://web.dev/samesite-cookies-explained/)

Implementar estas medidas reducir√° drasticamente o risco de ataques CSRF na t√∫a aplicaci√≥n web.

- **Soluci√≥ns**:  
  - Uso de **tokens CSRF** en formularios.  
  - Configurar a cabeceira `SameSite` en cookies.  

### **üìÅ 2.5. Configuraci√≥n segura do servidor**  

##### **üîê Obxectivo**

Garantir que o servidor web estea configurado con medidas de seguridade robustas para previr ataques, fuga de informaci√≥n e vulnerabilidades cr√≠ticas.

---

#### **üìå Medidas clave de seguridade**

##### **1. Xesti√≥n de actualizaci√≥ns**

‚úÖ **Mellor pr√°ctica**:
   - **Actualizaci√≥ns autom√°ticas** (cando sexa posible):
     ```bash
     # Ubuntu/Debian (actualizaci√≥ns de seguridade autom√°ticas)
     sudo apt-get install unattended-upgrades
     sudo dpkg-reconfigure --priority=low unattended-upgrades
     ```
   - **Versi√≥ns LTS** (Long-Term Support) para software cr√≠tico (Ubuntu Server, Nginx Stable).
   - **CMS**: Usar plugins de actualizaci√≥n autom√°tica para WordPress/Drupal (ex.: "Easy Updates Manager").

‚ö†Ô∏è **Comprobaci√≥n manual mensual** para:
   - Servidor web (Apache/Nginx)
   - Linguaxes (PHP, Python, Node.js)
   - Bases de datos (MySQL, PostgreSQL)
   - CMS e plugins

##### **2. Xesti√≥n de permisos de arquivos**

‚úÖ **Estrutura recomendada**:
   - `chmod 644` para arquivos (lectura/escrita para propietario, s√≥ lectura para outros).
   - `chmod 755` para directorios (execuci√≥n necesaria para navegar).
   - `chown www-data:www-data` (usuario espec√≠fico do servidor web).

üö´ **Permisos perigosos a evitar**:
   - `777` (acceso total para todos)
   - `666` (escrita aberta)

üìå **Exemplo de fixura masiva**:
```bash
# Arxivos
find /var/www/html -type f -exec chmod 644 {} \;

# Directorios
find /var/www/html -type d -exec chmod 755 {} \;

# Propiedade
chown -R www-data:www-data /var/www/html
```

##### **3. Configuraci√≥n segura do servidor web**

üîß **Apache**:
   - Desactivar listaxe de directorios:
     ```apache
     Options -Indexes
     ```
   - Deshabilitar assinatura do servidor:
     ```apache
     ServerSignature Off
     ServerTokens Prod
     ```

üîß **Nginx**:
   - Ocultar versi√≥n:
     ```nginx
     server_tokens off;
     ```
   - Desactivar m√©todos inseguros:
     ```nginx
     if ($request_method !~ ^(GET|HEAD|POST)$ ) {
         return 405;
     }
     ```

##### **4. Configuraci√≥n adicional cr√≠tica**

‚úÖ **PHP (php.ini)**:
   ```ini
   expose_php = Off
   disable_functions = exec,passthru,shell_exec,system
   allow_url_fopen = Off
   ```

‚úÖ **Protecci√≥n contra ataques DDoS**:
   - Limitar conexi√≥ns simult√°neas:
     ```nginx
     limit_conn_zone $binary_remote_addr zone=conn_limit:10m;
     limit_conn conn_limit 20;
     ```

‚úÖ **Firewall (UFW)**:
   ```bash
   sudo ufw allow 80/tcp
   sudo ufw allow 443/tcp
   sudo ufw enable
   ```

---

#### **üîß Ferramentas recomendadas**

- **Lynis**: Auditor√≠a de seguridade do servidor
  ```bash
  sudo apt-get install lynis
  sudo lynis audit system
  ```
- **Fail2Ban**: Protecci√≥n contra forza bruta
  ```bash
  sudo apt-get install fail2ban
  ```
- **CIS Benchmarks**: Configuraci√≥ns seguras est√°ndar

---

#### **üìä T√°boa de comprobaci√≥n r√°pida**

| Medida          | Comando/Configuraci√≥n                         | Prioridade |
| --------------- | --------------------------------------------- | ---------- |
| Actualizaci√≥ns  | `sudo apt update && sudo apt upgrade`         | Alta       |
| Permisos        | `find /var/www -type d -exec chmod 755 {} \;` | Alta       |
| Ocultar versi√≥n | `ServerTokens Prod` (Apache)                  | Media      |
| Firewall        | `sudo ufw enable`                             | Alta       |

---

#### **üöÄ Conclusi√≥n**

Unha configuraci√≥n segura do servidor require:
1. **Actualizaci√≥ns constantes** de todo o software.
2. **Xesti√≥n estrita de permisos** (principio do m√≠nimo privilexio).
3. **Configuraci√≥ns espec√≠ficas** para Apache/Nginx/PHP.
4. **Ferramentas adicionais** de monitorizaci√≥n e protecci√≥n.

üîó **Recursos**:
- [Gu√≠a de Seguridade de Apache](https://httpd.apache.org/docs/2.4/misc/security_tips.html)
- [Bancos de probas CIS](https://www.cisecurity.org/cis-benchmarks/)

Implementar estas medidas reducir√° drasticamente a superficie de ataque do teu servidor web.

- **Medidas clave**:  
  - Actualizar sempre o software (PHP, Apache, Nginx, CMS como WordPress).  
  - Restrinxir permisos de arquivos (`chmod 644` para arquivos, `755` para directorios).  
  - Desactivar a listaxe de directorios (`Options -Indexes` en Apache).  

### **üîÑ 2.6. Copias de seguridade (Backups)**

#### **üîê Obxectivo**

Implementar un sistema de copias de seguridade **resistente a fallos** que protexa contra:
- Erros humanos
- Ataques ransomware
- Fallos de hardware
- Desastres naturais

---

#### **üìå Estratexia completa de *backups***

##### **1. Pol√≠tica 3-2-1 (Est√°ndar Ouro)**

‚úÖ **3** copias dos datos  
‚úÖ **2** medios de almacenamento diferentes  
‚úÖ **1** copia en localizaci√≥n remota  

##### **2. Almacenamento seguro**

| Opci√≥n                      | Vantaxes                      | Recomendaci√≥n                           |
| --------------------------- | ----------------------------- | --------------------------------------- |
| **AWS S3**                  | Alta durabilidade, versionado | Usar S3 Intelligent-Tiering para aforro |
| **Backblaze B2**            | M√°is barato que S3            | Ideal para PYMEs                        |
| **Google Drive Enterprise** | Integraci√≥n con GSuite        | Cifrado con rclone                      |
| **Servidor NAS local**      | Acceso r√°pido                 | RAID 5/6 + copia en nube                |

üìå **Exemplo AWS CLI para backup cifrado**:
```bash
aws s3 sync /var/www/ s3://meu-bucket-backup/ \
--sse AES256 \
--exclude "*.tmp" \
--delete
```

##### **3. Automatizaci√≥n con *cron* e ferramentas especializadas**

üîß **Opci√≥ns**:
- **Duplicity** (backups incrementais cifrados)
- **BorgBackup** (deduplicaci√≥n e compresi√≥n)
- **Rsync + SSH** (para transferencias seguras)

üìå **Exemplo de cron para backup diario**:
```bash
0 3 * * * /usr/bin/duplicity /var/www scp://user@backup-server:/backups --encrypt-key=ABCD1234
```

##### **4. Proba de restauraci√≥n (o paso m√°is cr√≠tico!)**

‚úÖ **Protocolo obrigatorio**:
1. Probar restauraci√≥n **trimestralmente**
2. Documentar tempo de recuperaci√≥n (RTO)
3. Verificar integridade de datos (checksums)

üìå **Checklist de verificaci√≥n**:
- [ ] Os arquivos restauran sen erros
- [ ] As bases de datos son consistentes
- [ ] Os permisos se mant√©n
- [ ] O CMS funciona correctamente

##### **5. Seguridade adicional**

- **Cifrado**: AES-256 para datos en tr√°nsito e en repouso
- **Control de acceso**: MFA para buckets S3/Backblaze
- **Retenci√≥n**: Pol√≠tica de 90 d√≠as para borrado accidental
- **Monitorizaci√≥n**: Alertas por fallos de backup

---

#### **üîß Integraci√≥n con sistemas CI/CD**

```yaml
# Exemplo GitLab CI
backup_production:
  stage: deploy
  script:
    - mysqldump -u $DB_USER -p$DB_PASS $DB_NAME | gzip > backup.sql.gz
    - aws s3 cp backup.sql.gz s3://meu-bucket/$(date +%Y-%m-%d).sql.gz
  only:
    - cron  # Executar diariamente
```

---

##### **üìä T√°boa de recuperaci√≥n ante desastres**

| Escenario           | Procedemento                      | Tempo estimado |
| ------------------- | --------------------------------- | -------------- |
| Borrado accidental  | Restaurar de S3 versionado        | <1h            |
| Ataque ransomware   | Restauraci√≥n completa de snapshot | 2-4h           |
| Fallo do datacenter | Activar r√©plica en outra rexi√≥n   | 30min          |

---

#### **üöÄ Conclusi√≥n**

Un sistema de backups profesional require:
1. **Automatizaci√≥n completa** con ferramentas especializadas
2. **Cifrado end-to-end** de todos os datos
3. **Probas regulares** de restauraci√≥n
4. **Integraci√≥n** co fluxo de desenvolvemento

üîó **Recursos**:
- [Gu√≠a NIST de Backup](https://www.nist.gov/itl)
- [AWS Well-Architected Backup](https://aws.amazon.com/architecture/well-architected)

Implementar esta estratexia garantir√° que os teus datos sobrevivan a calquera incidente cr√≠tico.

- **Estratexia**:  
  - Facer backups **autom√°ticos** e almacenalos en servidores seguros (ex.: AWS S3, Google Drive cifrado).  
  - Probar a restauraci√≥n periodicamente.  

### **üîç 2.7. Monitorizaci√≥n e rexistro (Logging)**  

##### **üîê Obxectivo**

Implementar un sistema exhaustivo de monitorizaci√≥n e rexistro que permita:
- Detectar e responder a incidentes de seguridade en tempo real
- Cumprir con regulaci√≥ns de protecci√≥n de datos (GDPR, PCI DSS)
- Analizar o rendemento e comportamento da aplicaci√≥n
- Investigar incidentes de forma retrospectiva

---

#### **üìå Ferramentas e t√©cnicas esenciais**

##### **1. Xesti√≥n de rexistros (Logging)**

‚úÖ **Rexistros b√°sicos obrigatorios**:
   - **Apache**:
     ```apache
     CustomLog /var/log/apache2/access.log combined
     ErrorLog /var/log/apache2/error.log
     ```
   - **Nginx**:
     ```nginx
     access_log /var/log/nginx/access.log;
     error_log /var/log/nginx/error.log warn;
     ```

‚úÖ **Boas pr√°cticas**:
   - Rotaci√≥n diaria de logs con **logrotate**:
     ```bash
     /var/log/nginx/*.log {
         daily
         missingok
         rotate 14
         compress
         delaycompress
         notifempty
         create 0640 www-data adm
         sharedscripts
         postrotate
             /usr/bin/systemctl reload nginx.service >/dev/null 2>&1 || true
         endscript
     }
     ```
   - Env√≠o a **syslog** centralizado para maior seguridade

##### **2. Ferramentas de seguridade avanzada**

üõ°Ô∏è **Fail2Ban**:
   - Filtrado inteligente de IPs maliciosas
   - Exemplo de configuraci√≥n para WordPress:
     ```ini
     [wordpress-auth]
     enabled = true
     filter = wordpress
     logpath = /var/log/nginx/access.log
     maxretry = 3
     bantime = 86400
     ```

üõ°Ô∏è **ModSecurity** (WAF - Web Application Firewall):
   - Regras OWASP CRS (Core Rule Set)
   - Configuraci√≥n b√°sica:
     ```apache
     <IfModule security2_module>
         SecRuleEngine On
         SecAuditLog /var/log/modsecurity/modsec_audit.log
         Include /etc/modsecurity/crs-setup.conf
         Include /etc/modsecurity/rules/*.conf
     </IfModule>
     ```

##### **3. Soluci√≥ns profesionais de monitorizaci√≥n**

üîç **Stack ELK (Elasticsearch, Logstash, Kibana)**:
   - Centralizaci√≥n e an√°lise de logs
   - Dashboard para visualizaci√≥n de ataques

üìà **Prometheus + Grafana**:
   - Monitorizaci√≥n en tempo real
   - Alertas personalizadas

‚òÅÔ∏è **Soluci√≥ns en nube**:
   - AWS CloudWatch
   - Google Cloud Logging
   - Azure Monitor

---

#### **üîß Configuraci√≥n avanzada**

##### **4. Rexistros estruturados (JSON)**

```nginx
log_format json_combined escape=json
    '{'
        '"time_local":"$time_local",'
        '"remote_addr":"$remote_addr",'
        '"request":"$request",'
        '"status": "$status",'
        '"user_agent":"$http_user_agent"'
    '}';

access_log /var/log/nginx/access.log json_combined;
```

##### **5. Monitorizaci√≥n de actividade sospeitosa**

- Patr√≥ns a monitorizar:
  - Intentos de inxecci√≥n SQL (`UNION SELECT`, `DROP TABLE`)
  - Escaneo de vulnerabilidades (`/wp-admin`, `/phpmyadmin`)
  - Ataques XSS (`<script>`, `alert(`)

##### **6. Integraci√≥n con SIEM**

- Soluci√≥ns como **Splunk** ou **Wazuh**
- Correlaci√≥n de eventos entre m√∫ltiples fontes

---

#### **üìä T√°boa de priorizaci√≥n de alertas**

| Nivel     | Tipo de Incidente  | Exemplo                 | Acci√≥n             |
| --------- | ------------------ | ----------------------- | ------------------ |
| üî¥ Cr√≠tico | Ataque DDoS        | 1000+ requests/seg      | Activar mitigaci√≥n |
| üü° Alto    | Forza bruta        | 10+ intentos login      | Bloquear IP        |
| üîµ Medio   | Scanner autom√°tico | User-Agent "nikto"      | Rexistrar          |
| ‚ö™ Baixo   | Erros 404          | Arquivos non existentes | Ignorar            |

---

#### **üöÄ Conclusi√≥n**

Un sistema de monitorizaci√≥n profesional require:
1. **Rexistros detallados** con rotaci√≥n e almacenamento seguro
2. **Ferramentas especializadas** (Fail2Ban, ModSecurity)
3. **An√°lise centralizada** (ELK, SIEM)
4. **Protocolos de resposta** a incidentes

üîó **Recursos**:
- [Gu√≠a OWASP de Logging](https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html)
- [Documentaci√≥n oficial de ModSecurity](https://www.modsecurity.org/)

Implementar estas medidas proporcionar√° visibilidade completa sobre a seguridade e rendemento das t√∫as aplicaci√≥ns web.

- **Ferramentas √∫tiles**:  
  - **Fail2Ban** (para bloquear IPs maliciosas).  
  - **ModSecurity** (firewall para aplicaci√≥ns web).  
  - Rexistros de acceso/erro en Apache/Nginx (`access.log`, `error.log`).  

---

## **3. Ferramentas de an√°lise de seguridade**  

##### **üîê Obxectivo**

Identificar e mitigar vulnerabilidades en aplicaci√≥ns web mediante ferramentas especializadas que cubran diferentes capas de seguridade, dende a infraestrutura ata o c√≥digo fonte.

---

#### **üìå Ferramentas esenciais por categor√≠a**

##### **1. An√°lise de vulnerabilidades en aplicaci√≥ns web**

üõ°Ô∏è **[OWASP ZAP](https://www.zaproxy.org/)** (Zed Attack Proxy)
   - **Caracter√≠sticas avanzadas**:
     - Escaneo activo/pasivo
     - Interceptaci√≥n de tr√°fico (proxy)
     - Detecci√≥n de OWASP Top 10 (XSS, SQLi, CSRF)
     - API para integraci√≥n CI/CD
   - **Uso recomendado**:
     ```bash
     zap-cli quick-scan --self-contained --start-options '-config api.key=12345' http://example.com
     ```

üîç **[Burp Suite](https://portswigger.net/burp)**
   - **Versi√≥n Pro** para pentesting profesional
   - Scanner autom√°tico de vulnerabilidades
   - An√°lise de business logic flaws

##### **2. Escaneo de infraestrutura**

üîé **[Nmap](https://nmap.org/)**
   - **Comandos avanzados**:
     - Detecci√≥n de servizos: `nmap -sV -O IP`
     - Escaneo completo: `nmap -p- -T4 -A -v IP`
     - Scripts NSE: `nmap --script vuln IP`
   - **Alternativas**:
     - [Masscan](https://github.com/robertdavidgraham/masscan) (escaneo r√°pido)
     - [RustScan](https://github.com/RustScan/RustScan) (escaneo con Rust)

##### **3. Seguridade en contido e malware**

ü¶† **[Sucuri](https://sucuri.net/)**
   - **Funcionalidades premium**:
     - Limpeza autom√°tica de malware
     - Firewall aplicativo (WAF)
     - Monitorizaci√≥n de blacklists
   - **Alternativas open-source**:
     - [Lynis](https://cisofy.com/lynis/) (auditor√≠a de servidores)
     - [ClamAV](https://www.clamav.net/) (antivirus para servidores)

##### **4. An√°lise est√°tico de c√≥digo (SAST)**

üíª **[Semgrep](https://semgrep.dev/)**
   - Detecci√≥n de vulnerabilidades en c√≥digo
   - Soporte para m√∫ltiples linguaxes
   - Integraci√≥n con GitHub/GitLab

üìú **[SonarQube](https://www.sonarqube.org/)**
   - An√°lise continuo de calidade de c√≥digo
   - Detecci√≥n de security hotspots

---

#### **üîß Integraci√≥n en pipelines CI/CD**

```yaml
# Exemplo GitLab CI
stages:
  - security

owasp_zap_scan:
  stage: security
  image: owasp/zap2docker-stable
  script:
    - zap-baseline.py -t https://${URL} -r report.html
  artifacts:
    paths: [report.html]

nmap_scan:
  stage: security
  image: instrumentisto/nmap
  script:
    - nmap -sV --script vuln -oA scan ${URL}
```

---

#### **üìä T√°boa comparativa**

| Ferramenta     | Tipo    | Licenza     | Puntos Fortes              |
| -------------- | ------- | ----------- | -------------------------- |
| **OWASP ZAP**  | DAST    | Open-source | Detecci√≥n OWASP Top 10     |
| **Burp Suite** | DAST    | Comercial   | An√°lise avanzado manual    |
| **Nmap**       | Network | Open-source | Escaneo de portos/servizos |
| **Sucuri**     | WAF     | SaaS        | Protecci√≥n en tempo real   |
| **Semgrep**    | SAST    | Open-source | An√°lise de c√≥digo r√°pido   |

---

#### **üöÄ Boas pr√°cticas adicionais**

1. **Escaneos regulares** (semanalmente en producci√≥n)
2. **Combinar ferramentas** (SAST + DAST + WAF)
3. **Priorizar vulnerabilidades** usando CVSS
4. **Documentar resultados** en sistemas como DefectDojo

Implementar estas ferramentas como parte do teu SDLC reducir√° drasticamente os riscos de seguridade nos teus proxectos web.

üîó **Recursos**:

- [**Gu√≠a OWASP de Testing**](https://owasp.org/www-project-web-security-testing-guide/)
- [**NIST Security Tools**](https://www.nist.gov/itl/ssd/software-quality-group/security-tools)

- **[OWASP ZAP](https://www.zaproxy.org/)**: Esc√°ner de vulnerabilidades.  
- **[Nmap](https://nmap.org/)**: Para analizar portos abertos.  
- **[Sucuri](https://sucuri.net/)**: Escaneo de malware e protecci√≥n DDoS.  

---

## **4. Conclusi√≥n**  
A seguridade web debe ser unha prioridade dende o dese√±o ata a publicaci√≥n. Implementar HTTPS, validar datos, xestionar contrasinais con hash e manter o servidor actualizado son pasos esenciais. Ademais, √© recomendable realizar auditor√≠as peri√≥dicas con ferramentas como OWASP ZAP para detectar vulnerabilidades a tempo.  

üëâ **Acci√≥n recomendada**: Se usas un CMS como WordPress, instala plugins de seguridade como **Wordfence** ou **Sucuri Security**.  

---

#### Lecturas adicionais:
- [PHP MySQL Prepared Statements](https://www.w3schools.com/php/php_mysql_prepared_statements.asp)


---

DAWüßä2025